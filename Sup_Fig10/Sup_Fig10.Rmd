---
title: "sup_fig_10"
author: "ZH"
date: "2024-08-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Sup_Fig10
```{r}
library(dplyr)
library(ggplot2)
library(ggpubr)

# 读取数据
data <- read.table("PEG_phenotype.txt", header = TRUE, sep = "\t")
gt <- c("Col_0", "ost1_3", "ein3 eil1", "coi1_16", "npr1")

# 筛选展示基因型和组别
data <- data %>% 
  filter(genotype %in% gt, group == "RM") %>%
  dplyr::select(-shoot_weight) %>%
  mutate(facet = paste(group, genotype, sep = "_"),
         inoculation = factor(inoculation, levels = c("buffer", "Rhizobium sp.4F10")))

# 绘制图形
p <- ggplot(data, aes(x = inoculation, y = primary_root_length, color = inoculation, group = inoculation, fill = inoculation)) +
  coord_cartesian(ylim = c(4, max(data$primary_root_length) * 1.05)) +
  stat_summary(fun = mean, geom = "bar", width = 0.7) +
  stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), geom = "errorbar", width = 0.2) +
  stat_compare_means(method = "t.test", aes(label = ..p.signif..), label.x.npc = "center", label.y = 8.5, size = 3.0) +
  labs(title = paste0("PEG_", unique(data$group), "_", "Primary root length"), x = "Genotype", y = "Primary root length (cm)") +
  scale_fill_manual(values = c("green3", "steelblue1"), guide = guide_legend(reverse = TRUE)) +
  theme_bw()  +
  facet_grid(~facet, scales = 'free')
p

```
